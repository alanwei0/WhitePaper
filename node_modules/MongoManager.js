var mongo;
var db;
var new_room;
var new_stroke_path;
var rooms;
var strokepath;

exports.init = function(host, port, name , server_options, db_options){
    if(!db){
        mongodb = require("mongodb");
        var mongoserver = new mongodb.Server(host, port, server_options);
        db = new mongodb.Db(name, mongoserver, db_options);
        db.open(function(err,db){
            db.on("close", function(error){
                console.log("Connection to the database was closed!");
            });
        });
        rooms = this.db.collection('rooms');
        strokepath = this.db.collection('strokepath');
    }     
};


exports.addRoom = function(room){
    if(!rooms) console.log('database is not inited');
    new_room._id = room[0];
    new_room.password = room[1];
    new_room.creator = room[2];
    new_room.createTime = new Date();
    rooms.insert(new_room, {'safe':true}, function(err, records){
        if(err){
            console.log(err);
        }else{
            console.log("Record added as "+records[0]._id);
        }  
    });
},

exports.roomExist = function(roomId){
    var cursor = this.rooms.findOne({'_id': roomId}, function(err,doc){
            
    });

};

exports.roomExistRespond = function(err,doc){

};
